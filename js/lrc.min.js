/*Audio音乐歌词滚动显示 Javascript插件 v16.0726
https://git.coding.net/xcr_abcd/music.git
js压缩 UglifyJS http://tool.css-js.com/
* */
!function(a,b,c){function i(a,b){this.audio=a,this.lrc=b.dom.getElementsByTagName("p"),this.dom=b.dom,this.current=0,this.currentTime=0,this.options=e.extend(g,f),b.offset!=c&&(this.options.offset=b.offset),b.fix!=c&&(this.options.fix=b.fix),null==this.options.initMargin&&(this.options.initMargin=parseInt(e(this.dom).css("marginTop"))),this.lrcobj=b}function j(a){var c,b=[];for(c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.push(("v="+Math.random()).replace(".","")),b.join("&")}function k(a){for(var b=a.split("\n"),c=/\[\d{2}:\d{2}.\d{2}\]/g,d=[];!c.test(b[0]);)b=b.slice(1);return 0===b[b.length-1].length&&b.pop(),b.forEach(function(a){var f=a.match(c),g=a.replace(c,"");null!=f&&f.forEach(function(a){var e=a.slice(1,-1).split(":");d.push([60*parseInt(e[0],10)+parseFloat(e[1]),g])})}),d.sort(function(a,b){return a[0]-b[0]}),d}function l(a,b){return a>b||Math.abs(a-b)<=.5}function m(a,b,c){this.dom=a,"function"==typeof b&&(a.ontimeupdate=function(){b(this.currentTime)}),"function"==typeof c&&(a.onseeked=function(){c(this.currentTime)})}function n(b,c,d){if("object"!=typeof a.audiojs&&"object"!=typeof a.audiojs.events)throw new ReferenceError("audiojs is not correctly defined!");audiojs.events.ready(function(){var a=audiojs.create(b,{updatePlayhead:function(b){"function"==typeof c&&c(a.duration*b)},skipTo:function(b){"function"==typeof d&&d(a.duration*b)}})})}var e,f,g,d=function(a){return new d.fn.init(a)};d.fn=d.prototype={init:function(a){this.dom=a},css:function(b){var c=this.dom;return"undefined"!=typeof a.getComputedStyle?a.getComputedStyle(c,null)[b]:c.currentStyle[b]},data:function(a,b){var e,d=this.dom;return d.dataset?b==c?d.dataset[a]:d.dataset[a]=b:(e="data-"+a,b==c?d.getAttribute(e):d.setAttribute(e,b))},extend:function(a,b){for(name in b)a[name]=b[name];return a}},d.fn.init.prototype=d.fn,d.extend=d.fn.extend,d.get=function(b,c,d){var e,f,g;if("undefined"!=typeof d&&"function"!=typeof d)throw new TypeError(d+" is not a function");e=a.XMLHttpRequest?new a.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),f=b,"undefined"!=typeof c&&(g=j(c),f=f+"?"+g),e.open("GET",f,!0),e.onreadystatechange=function(){if(4==e.readyState){var a=e.status;a>=200&&300>a&&d(e.responseText,a,e)}},e.send()},e=a.jQuery?a.jQuery:d,a.jQuery&&e.fn.extend({loadLrc:function(b){return a.loadLrc(this[0],b)},activeAudio:function(b){return a.activeAudio(this[0],b)},lrc:function(b,c){var d=a.loadLrc(this[0],b),f=e(c);a.activeAudio(f[0],d)}}),f=a.lrcCtrl={},g={active:function(a){a.style.fontWeight="700"},normal:function(a){a.style.fontWeight="normal"},fix:28,initMargin:null,offset:0},f.active=function(a){a.style.fontWeight="700"},f.normal=function(a){a.style.fontWeight="normal"},e.lrcCtrl=a.lrcCtrl,a.lrcFix=28,i.prototype.active=function(a){"function"==typeof this.lrcobj.active?this.lrcobj.active(a):"function"==typeof f.active&&f.active(a)},i.prototype.normal=function(a){"function"==typeof this.lrcobj.normal?this.lrcobj.normal(a):"function"==typeof f.normal&&f.normal(a)},i.prototype.timeChanged=function(a){if(this.current!=this.lrc.length){var b=parseFloat(e(this.lrc[this.current]).data("time"))+this.options.offset;l(a,b)&&(this.moveNext(),this.current++)}},i.prototype.moveNext=function(){var a=parseInt(e(this.dom).css("marginTop"));this.current>0&&this.normal(this.lrc[this.current-1]),this.active(this.lrc[this.current]),this.dom.style.marginTop=a-this.options.fix+"px"},i.prototype.toggle=function(a){var c,d,f,b=-1;for(c=this.lrc.length-1;c>=0;c--)d=parseFloat(e(this.lrc[c]).data("time"))+this.options.offset,0>b&&l(a,d)&&(b=c),this.normal(this.lrc[c]);b<this.lrc.length&&b>0&&(f=this.options.initMargin-this.options.fix*b,this.dom.style.marginTop=f+"px",this.current=b)},Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,e,f,g,d=0;if(null==this)throw new TypeError(" this is null or not defined");if(e=Object(this),f=e.length>>>0,"function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(c=b);f>d;)d in e&&(g=e[d],a.call(c,g,d,e)),d++}),a.loadLrc=function(a,d){var f,g,h,i,j;if(this.dom=a,"function"==typeof d)for(f=d(),g=k(f),h=0;h<g.length;h++)i=g[h],j=b.createElement("p"),e(j).data("time",i[0]),j.innerHTML=i[1],j.style.overflow="hidden",a.appendChild(j);else e.get(d,c,function(c){var f,g,h,d=k(c);for(f=0;f<d.length;f++)g=d[f],h=b.createElement("p"),e(h).data("time",g[0]),h.innerHTML=g[1],h.style.overflow="hidden",a.appendChild(h)});return this},a.activeAudio=function(b,c){var d=new i(b,c),e=a.Audio?m:n;e(b,function(a){d.timeChanged(a)},function(a){d.toggle(a)})}}(window,window.document);
